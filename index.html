<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8">
      <title>EU-TIRADS-PL Classification</title>
      <style>
         .centered {
         text-align: center;
         }
         .category {
         margin-bottom: 25px;
         width: 100%;
         display: flex;
         vertical-align: top;
         }
         .left {
         flex: 45%;
         margin-top: -20px;
         margin-right: 20px;
         text-align: right;
         }
         .right {
         flex: 55%;
         text-align: left;
         }
      </style>
      <script>
         document.addEventListener('DOMContentLoaded', (event) => {
             document.getElementById('tiradsForm').reset();
         });
      </script>
   </head>
   <body>
      <h1 class="centered">EU-TIRADS-PL</h1>
      <h2 class="centered">
      Klasyfikacja Guzków Tarczycy</h1>
      <form id="tiradsForm">
         <div class="category">
            <div class="left">
               <h3>Tarczyca</h3>
            </div>
            <div class="right">
               <label>
               <input type="radio" name="nodule" value="1" onclick="blockFeatures()" checked> Tarczyca bez zmian ogniskowych
               </label><br>
               <label>
               <input type="radio" name="nodule" value="2.1" onclick="unblockFeatures()"> Zmiana ogniskowa bezechowa płynowa
               </label><br>
               <label>
               <input type="radio" name="nodule" value="2.2" onclick="unblockFeatures()"> Zmiana ogniskowa o strukturze gąbczastej typu „plastra miodu”
               </label><br>
               <label>
               <input type="radio" name="nodule" value="3" onclick="unblockFeatures()"> Zmiana ogniskowa normoechogeniczna
               </label><br>
               <label>
               <input type="radio" name="nodule" value="3" onclick="unblockFeatures()"> Zmiana ogniskowa hiperechogeniczna
               </label><br>
               <label>
               <input type="radio" name="nodule" value="4" onclick="unblockFeatures()"> Zmiana ogniskowa hipoechogeniczna
               </label>
            </div>
         </div>
         <div class="category">
            <div class="left">
               <h3>Kształt</h3>
            </div>
            <div class="right">
               <label>
               <input type="radio" name="shape" value="0" checked> Kształt owalny lub okrągły
               </label><br>
               <label>
               <input type="radio" name="shape" value="5"> Kształt nieregularny
               </label>
            </div>
         </div>
         <div class="category">
            <div class="left">
               <h3>Margines</h3>
            </div>
            <div class="right">
               <label>
               <input type="radio" name="margins" value="0" checked> Granice/brzegi równe
               </label><br>
               <label>
               <input type="radio" name="margins" value="5"> Granice/brzegi nierówne
               </label>
            </div>
         </div>
         <div class="category">
            <div class="left">
               <h3>Dodatkowe cechy</h3>
            </div>
            <div class="right">
               <label>
               <input type="checkbox" name="features" value="5" disabled> Orientacja nierównoległa
               </label><br>
               <label>
               <input type="checkbox" name="features" value="5" disabled> Mikrozwapnienia
               </label><br>
               <label>
               <input type="checkbox" name="features" value="5" disabled> Ekspansja pozatarczycowa
               </label><br>
               <label>
               <input type="checkbox" name="features" value="5" disabled> Głęboka hipoechogeniczność
               </label>
            </div>
         </div>
         <div class="centered">
            <button type="button" onclick="calculateCategory()">Oblicz kategorię</button>
         </div>
      </form>
      <h3 class="centered">Suma punktów: <span id="sum">0</span></h3>
      <h3 class="centered">EU-TIRADS-PL Kategoria: <span id="tiradsCategory">1</span></h3>
      <div id="result" class="result centered" style="margin-bottom: 25px;"></div>
      <div class="centered">
         <img src="logo-PWr.png" alt="PWr logo" width="70px">
         <img src="logo_pse.jpeg" alt="PSE logo" width="160px">
         <p>Made by Wiktor Sadowy & Tomasz Hałas, Department of Artificial Intelligence. Idea and Cooperation: Tomasz Tomkalski, Department of Medicine<br>© 2024 thyroID</p>
      </div>
      <div>
         References:
         <cite>
            <p>1. Jarząb B, Dedecjus M, Lewiński A, Adamczewski Z, Bakuła-Zalewska E, Bałdys-Waligórska A, Barczyński M, Biskup-Frużyńska M, Bobek-Billewicz B, Bossowski A, Buziak-Bereza M, Chmielik E, Czarniecka A, Czepczyński R, Ćwikła J, Dobruch-Sobczak K, Dzięcioł J, Gawlik A, Gawrychowski J, Handkiewicz-Junak D, Harasymczuk J, Hubalewska-Dydejczyk A, Januszkiewicz-Caulier J, Jarząb M, Kaczka K, Kalemba M, Kamiński G, Karbownik-Lewińska M, Kawecki A, Kluczewska-Gałka A, Kolasińska-Ćwikła A, Kołton M, Konturek A, Kos-Kudła B, Kotecka-Blicharz A, Kowalska A, Krajewska J, Kram A, Królicki L, Kukulska A, Kusiński M, Kuzdak K, Lange D, Ledwon A, Małecka-Tendera E, Mańkowski P, Migda B, Niedziela M, Oczko-Wojciechowska M, Polnik D, Pomorski L, Ruchała M, Samborski K, Skowrońska-Szcześniak A, Stanek-Widera A, Stobiecka E, Stojčev Z, Suchorzepka-Simek M, Syrenicz A, Szczepanek-Parulska E, Trofimiuk-Müldner M, Tysarowski A, Wygoda A, Zajkowska K, Zembala-Nożyńska E, Żyłka A. Diagnosis and treatment of thyroid cancer in adult patients - Recommendations of Polish Scientific Societies and the National Oncological Strategy. 2022 Update [Diagnostyka i leczenie raka tarczycy u chorych dorosłych - Rekomendacje Polskich Towarzystw Naukowych oraz Narodowej Strategii Onkologicznej. Aktualizacja na rok 2022]. Endokrynol Pol. 2022;73(2):173-300. doi: 10.5603/EP.a2022.0028. PMID: 35593680.</p>
         </cite>
      </div>
      <script>
         function blockFeatures() {
         
             var noduleOptions = document.getElementsByName("nodule");
             var disable = false;
             for (var i = 0; i < noduleOptions.length; i++) {
                 if (noduleOptions[i].checked && noduleOptions[i].value == "1") {
                     disable = true;
                     break;
                 }
             }
         
             let form = document.getElementById('tiradsForm');
             let checkboxes = form.elements['features']
         
             for (var i = 0; i < checkboxes.length; i++) {
                 checkboxes[i].disabled = disable;
                 if (disable) {
                     checkboxes[i].checked = false;
                 }
             }
         }
         
         function unblockFeatures() {
         
             let form = document.getElementById('tiradsForm');
             let checkboxes = form.elements['features']
         
             for (var i = 0; i < checkboxes.length; i++) {
                 checkboxes[i].disabled = false;
             }
         }
         
         function calculateCategory() {
             let form = document.getElementById('tiradsForm');
             let nodule = parseFloat(form.elements['nodule'].value) || 0;
             let shape = parseInt(form.elements['shape'].value) || 0;
             let margins = parseInt(form.elements['margins'].value) || 0;
         
             let featuresElements = form.elements['features']
             let featuresSum = 0;
             
             for (let i = 0; i < featuresElements.length; i++) {
                 if (featuresElements[i].checked) {
                     featuresSum += parseInt(featuresElements[i].value) || 0;
                 }
             }
             noduleDecimalPart = parseInt(nodule % 1 * 10);
             let totalPoints = parseInt(nodule) + shape + margins + featuresSum;
             let category;
         
             if (totalPoints >= 5) {
                 category = 5;
             } else if (totalPoints >= 4) {
                 category = 4;
             } else if (totalPoints >= 3) {
                 category = 3;
             } else if (totalPoints >= 2) {
                 category = 2;
             } else {
                 category = 1;
             }
         
             document.getElementById('tiradsCategory').innerText = category;
             document.getElementById('sum').innerText = totalPoints;
             
             gettext(category, noduleDecimalPart)
         }
      </script>
      <script>
         function gettext(category, type) {
             var resultText = '';
             console.log(category);
             console.log(type);
         
             switch (category) {
                 case 1:
                     resultText = 'Ryzyko złośliwości bliskie 0%.<br>BACC tarczycy niezalecana.<br>Kontrola USG w zależności od czynników ryzyka klinicznego.';
                     break;
                 case 2:
                     switch (type) {
                         case 1:
                             resultText = 'Ryzyko złośliwości bliskie 0%.<br>BACC tarczycy niezalecana.<br>Wyjątek: biopsja terapeutyczna u chorych objawowych, np. opróżnienie torbieli).<br>Kontrola USG w zależności od czynników ryzyka klinicznego.';
                             break;
                         case 2:
                             resultText = 'Ryzyko złośliwości bliskie 0%.<br>BACC tarczycy niezalecana.<br>Kontrola USG w zależności od czynników ryzyka klinicznego.';
                             break;
                     }
                     break;
                 case 3:
                     resultText = 'Niskie ryzyko złośliwości: 2–4%.<br>BACC tarczycy gdy ≥ 20 mm. <br> Można rozważyć BACC przy mniejszym wymiarze zmiany.';
                     break;
                 case 4:
                     resultText = 'Pośrednie ryzyko złośliwości 6–17%.<br>BACC tarczycy gdy ≥ 15 mm. <br> Można rozważyć BACC przy mniejszym wymiarze zmiany.';
                     break;
                 case 5:
                     resultText = 'Wysokie ryzyko złośliwości >26%.<br>BACC Tarczycy gdy ≥ 5 mm.';
                     break;
                 default:
                     resultText = 'Brak danych';
                     break;
             }
         
             resultText += "<br>BACC — biopsja aspiracyjna cienkoigłowa celowana"
         
             document.getElementById('result').innerHTML = resultText;
             document.getElementById('result').style.display = 'block';
             }
             
      </script>
   </body>
</html>