<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>EU-TIRADS-PL Classification</title>
    <style>
        .centered {
            text-align: center;
        }

        .category {
            margin-bottom: 25px;
            width: 100%;
            display: flex;
            vertical-align: top;
        }
        
        .left {
            flex: 45%;
            margin-top: -20px;
            margin-right: 20px;
            text-align: right;
        }

        .right {
            flex: 55%;
            text-align: left;
        }

    </style>
    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            document.getElementById('tiradsForm').reset();
        });
    </script>
</head>
<body>
    <h1 class="centered">EU-TIRADS-PL</h1>
    <h2 class="centered">Klasyfikacja Guzków Tarczycy</h1>
    
    <form id="tiradsForm">
        <div class="category">
            <div class="left">
                <h3>Tarczyca</h3>
            </div>
            <div class="right">
                <label>
                    <input type="radio" name="nodule" value="1"> Tarczyca bez zmian ogniskowych
                </label><br>
                <label>
                    <input type="radio" name="nodule" value="2.1"> Zmiana ogniskowa bezechowa płynowa
                </label><br>
                <label>
                    <input type="radio" name="nodule" value="2.2"> Zmiana ogniskowa o strukturze gąbczastej typu „plastra miodu”
                </label><br>
                <label>
                    <input type="radio" name="nodule" value="3"> Zmiana ogniskowa normoechogeniczna
                </label><br>
                <label>
                    <input type="radio" name="nodule" value="3"> Zmiana ogniskowa hiperechogeniczna
                </label><br>
                <label>
                    <input type="radio" name="nodule" value="4"> Zmiana ogniskowa hipoechogeniczna
                </label>
            </div>
        </div>
        <div class="category">
            <div class="left">
                <h3>Kształt</h3>
            </div>
            <div class="right">
                <label>
                    <input type="radio" name="shape" value="0"> Kształt owalny lub okrągły
                </label><br>
                <label>
                    <input type="radio" name="shape" value="5"> Kształt nieregularny
                </label>
            </div>
        </div>
        <div class="category">
            <div class="left">
                <h3>Margines</h3>
            </div>
            <div class="right">
                <label>
                    <input type="radio" name="margins" value="0"> Granice/brzegi równe
                </label><br>
                <label>
                    <input type="radio" name="margins" value="5"> Granice/brzegi nierówne
                </label>
            </div>
        </div>
        <div class="category">
            <div class="left">
                <h3>Dodatkowe cechy</h3>
            </div>
            <div class="right">
                <label>
                    <input type="checkbox" name="features" value="5"> Orientacja nierównoległa
                </label><br>
                <label>
                    <input type="checkbox" name="features" value="5"> Mikrozwapnienia
                </label><br>
                <label>
                    <input type="checkbox" name="features" value="5"> Ekspansja pozatarczycowa
                </label>
            </div>
        </div>
        <div class="centered">
            <button type="button" onclick="calculateCategory()">Calculate Category</button>
        </div>
    </form>

    <h3 class="centered">Suma punktów: <span id="sum">0</span></h3>

    <h3 class="centered">EU-TIRADS-PL Kategoria: <span id="tiradsCategory">1</span></h3>
    <div id="result" class="result centered" style="margin-bottom: 25px;"></div>

    <div class="centered">
        <img src="logo-PWr.png" alt="PWr logo" width="70px">
        <p>Application made by Wiktor Sadowy and Tomasz Hałas we współpracy z dr. Tomaszem Tomkalskim<br>© 2024 thyroID</p>
    </div>
    
    <script>
        function calculateCategory() {
            let form = document.getElementById('tiradsForm');
            let nodule = parseFloat(form.elements['nodule'].value) || 0;
            let shape = parseInt(form.elements['shape'].value) || 0;
            let margins = parseInt(form.elements['margins'].value) || 0;

            let featuresElements = form.elements['features']
            let featuresSum = 0;
            
            for (let i = 0; i < featuresElements.length; i++) {
                if (featuresElements[i].checked) {
                    featuresSum += parseInt(featuresElements[i].value) || 0;
                }
            }
            noduleDecimalPart = parseInt(nodule % 1 * 10);
            let totalPoints = parseInt(nodule) + shape + margins + featuresSum;
            let category;

            if (totalPoints >= 5) {
                category = 5;
            } else if (totalPoints >= 4) {
                category = 4;
            } else if (totalPoints >= 3) {
                category = 3;
            } else if (totalPoints >= 2) {
                category = 2;
            } else {
                category = 1;
            }

            document.getElementById('tiradsCategory').innerText = category;
            document.getElementById('sum').innerText = totalPoints;
            
            gettext(category, noduleDecimalPart)
        }
    </script>

    <script>

function gettext(category, type) {
    var resultText = '';
    console.log(category);
    console.log(type);

    switch (category) {
        case 1:
            resultText = 'Ryzyko złośliwości blisko 0.<br>BACC Tarczycy nie jest potrzebna.<br>Kontrola usg zależnie od czynników ryzyka klinicznego.';
            break;
        case 2:
            switch (type) {
                case 1:
                    resultText = 'Ryzyko złośliwości blisko 0.<br>BACC Tarczycy nie jest potrzebna.<br>Wyjątek: biopsja terapeutyczna u chorych objawowych, np. opróżnienie torbieli).<br>Kontrola usg zależnie od czynników ryzyka klinicznego.';
                    break;
                case 2:
                    resultText = 'Ryzyko złośliwości blisko 0.<br>BACC Tarczycy nie jest potrzebna.<br>Kontrola usg zależnie od czynników ryzyka klinicznego.';
                    break;
            }
            break;
        case 3:
            resultText = 'Niskie ryzyko złośliwości: 2–4%.<br>BACC Tarczycy gdy ≥ 20 mm.';
            break;
        case 4:
            resultText = 'Pośrednie ryzyko złośliwości 6–17%.<br>BACC Tarczycy gdy ≥ 15 mm.';
            break;
        case 5:
            resultText = 'Wysokie ryzyko złośliwości >26%.<br>BACC Tarczycy gdy ≥ 5 mm.';
            break;
        default:
            resultText = 'Brak danych';
            break;
    }

    document.getElementById('result').innerHTML = resultText;
    document.getElementById('result').style.display = 'block';
    }
    </script>
</body>
</html>
